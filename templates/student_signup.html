<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Signup - Query Portal</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- HEADER -->
    <header class="site-header">
        <div class="header-container" style="justify-content: center;">
            <img src="{{ url_for('static', filename='images/cmp_header.jpg') }}"
                 alt="CMP Degree College Header Image"
                 style="width: 100%; max-width: 826px; height: auto; display: block; margin: 0 auto;">
        </div>
    </header>

    <!-- FORM -->
    <main class="login-main">
        <section class="login-section">
            <div class="login-container">
                <h2>Create Student Account</h2>
                
                {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <p style="color: red;">{{ message }}</p>
                    {% endfor %}
                {% endif %}
                {% endwith %}
                
                <form method="POST" action="{{ url_for('student_signup') }}" id="signupForm">
                    <div class="form-group">
                        <label for="full_name">Full Name</label>
                        <input type="text" class="form-control" id="full_name" name="full_name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" class="form-control" id="email" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Create Password</label>
                        <input type="password" class="form-control" id="password" name="password" minlength="8" required>
                        <button type="button" class="btn btn-secondary btn-sm mt-1" onclick="generateStrongPassword()">Generate Strong Password</button>
                    </div>
                    
                    <div class="form-group">
                        <label for="confirm_password">Confirm Password</label>
                        <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                    </div>
                    
                    <button type="submit" class="btn-main">Create Account</button>
                </form>
                
                <div class="login-links">
                    <a href="{{ url_for('student_login') }}">Back to Login</a>
                    <a href="/">Back to Home</a>
                </div>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="copyright">
                Copyright Â© 2025. All rights reserved.
            </div>
        </div>
    </footer>

<script>
function generateStrongPassword() {
    const lowers = 'abcdefghijklmnopqrstuvwxyz';
    const uppers = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const nums = '0123456789';
    const specials = '!@#$%^&*()-_=+[]{};:,.<>?/';
    let pw = '';
    pw += lowers[Math.floor(Math.random() * lowers.length)];
    pw += uppers[Math.floor(Math.random() * uppers.length)];
    pw += nums[Math.floor(Math.random() * nums.length)];
    pw += specials[Math.floor(Math.random() * specials.length)];
    const all = lowers + uppers + nums + specials;
    for (let i = 0; i < 8; i++) {
        pw += all[Math.floor(Math.random() * all.length)];
    }
    pw = pw.split('').sort(() => 0.5 - Math.random()).join('');
    const passwordField = document.getElementById('password');
    passwordField.value = pw.slice(0, 12);
    passwordField.dispatchEvent(new Event('input', { bubbles: true }));
}

// Real-time password confirmation validation
document.getElementById('confirm_password').addEventListener('input', function() {
    const password = document.getElementById('password').value;
    const confirmPassword = this.value;
    const submitBtn = document.querySelector('.btn-main');
    
    if (confirmPassword && password !== confirmPassword) {
        this.style.borderColor = '#dc3545';
        submitBtn.disabled = true;
        submitBtn.textContent = 'Passwords do not match';
    } else {
        this.style.borderColor = password ? '#28a745' : '';
        submitBtn.disabled = false;
        submitBtn.textContent = 'Create Account';
    }
});

// Form submission validation
document.getElementById('signupForm').addEventListener('submit', function(e) {
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('confirm_password').value;
    
    if (password !== confirmPassword) {
        e.preventDefault();
        alert('Passwords do not match!');
        return false;
    }
});
</script>
</body>
</html>
